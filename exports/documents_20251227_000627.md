# 项目文档

## QUICK_START.md

# 🚀 Gemini Pro AI 协同系统 - 快速开始指南

**⏱️ 只需 5 分钟上手！**

---

## 1️⃣ 最快的开始方式 (一行代码)

```bash
python3 gemini_review_bridge.py
```

**这将自动为您**:
- 📊 收集最新项目状态
- 💻 读取核心代码文件
- 🎯 获取 Notion 中的最新任务
- 🤖 发送给 Gemini Pro 进行评估
- 📝 保存报告到本地和 Notion

**时间**: ~2-3 分钟

---

## 2️⃣ 在 Notion 中创建任务 (更灵活)

1. 打开 [AI Command Center](https://www.notion.so/2cfc88582b4e817ea4a5fe17be413d64)
2. 点击 "New"
3. 填写任务:

```
标题: 🔍 评估工单 #011 MT5 实盘交易系统

上下文文件:
- src/strategy/risk_manager.py
- src/mt5/connection.py
- nexus_with_proxy.py

审查重点:
- 代码质量和最佳实践
- 潜在的 bug 或安全问题
- 性能优化机会
- 下一步建议
```

4. 运行: `python3 gemini_review_bridge.py`

---

## 3️⃣ 标准开发工作流 (自动同步)

```bash
# 编写代码
vim src/strategy/my_feature.py

# 标准化提交 (使用模板)
git add src/strategy/my_feature.py
git commit

# 或者一行提交
git commit -m "feat(strategy): 实现新策略功能 #011

- 添加动态仓位调整
- 集成 Kelly 公式
- 更新风险管理器"

# 推送到 GitHub
git push
```

**自动发生**:
- ✅ Git Hook 触发
- ✅ Notion 工单状态自动更新
- ✅ 知识自动沉淀
- ✅ AI 审查任务自动创建

---

## 4️⃣ 4 个最常用的命令

### 获取项目评估
```bash
python3 gemini_review_bridge.py
```
**用途**: 获取 Gemini Pro 的项目评估和建议

---

### 检查系统状态
```bash
python3 check_sync_status.py
```
**用途**: 检查 Git、Notion、文件同步状态

---

### 查看最近提交
```bash
git log --oneline -10
```
**用途**: 查看最近的 Git 提交历史

---

### 查看 Notion 数据库
```bash
# 打开浏览器访问 Notion 数据库
AI Command Center:     https://www.notion.so/2cfc88582b4e817ea4a5fe17be413d64
Issues:                https://www.notion.so/2cfc88582b4e816b9a15d85908bf4a21
Knowledge Graph:       https://www.notion.so/2cfc88582b4e811d83bed3bd3957adea
MT5-CRS Nexus:        https://www.notion.so/2cfc88582b4e801bb15bd96893b7ba09
```

---

## 5️⃣ 4 个最常见的场景

### 📊 每周项目评估

```bash
python3 gemini_review_bridge.py
```

**Gemini Pro 会提供**:
- 本周开发进展
- 完成的工单
- 发现的问题
- 下周建议

---

### 🔍 代码审查

在 Notion AI Command Center 创建任务，然后:

```bash
python3 gemini_review_bridge.py
```

**Gemini Pro 会审查**:
- 代码质量
- 设计模式
- 潜在 bug
- 改进建议

---

### ⚠️ 风险评估

在 Notion 创建任务指定风险评估，然后:

```bash
python3 gemini_review_bridge.py
```

**Gemini Pro 会分析**:
- 技术风险
- 业务风险
- 优先级排序
- 缓解方案

---

### 📝 技术债务评估

在 Notion 创建任务指定技术债务评估，然后:

```bash
python3 gemini_review_bridge.py
```

**Gemini Pro 会提供**:
- 当前技术债务清单
- 影响程度评估
- 优先级排序
- 改进计划

---

## 🎯 预期结果示例

运行 `python3 gemini_review_bridge.py` 后，Gemini Pro 会返回类似的评估报告:

### 📊 项目状态评估

```
# MT5-CRS 项目评估报告

## 当前状态
- 工单 #011 (MT5 实盘交易系统): 进行中
- 最近提交: feat(nexus): 完成 Notion Nexus 知识库部署
- 开发周期: 第 11 周

## 已完成成就
- ✅ 75+ 维度特征工程
- ✅ 机器学习框架
- ✅ 回测验证系统
- ✅ 数据质量监控
- ✅ AI 协同机制

## 当前焦点
- 🎯 MT5 API 集成
- 🎯 Kelly 资金管理
- 🎯 实盘交易系统

## 建议下一步
1. 完成 MT5 连接模块 (预计 2-3 天)
2. 集成 Kelly 资金管理系统 (预计 2-3 天)
3. 部署到生产环境 (预计 1-2 天)
4. 实盘小额测试 (预计 1 周)

## 风险识别
- ⚠️ API 连接稳定性
- ⚠️ 资金管理安全性
- ⚠️ 交易延迟问题

## 优化建议
1. 添加断路器机制
2. 增加交易延迟监控
3. 完善风险管理告警
```

---

## 💡 5 个专业技巧

### 1️⃣ 聚焦特定问题
创建 Notion 任务时，明确指定审查范围和重点，Gemini Pro 会更有针对性。

### 2️⃣ 定期对比
每周保存评估报告，对比改进：
```bash
python3 gemini_review_bridge.py > reports/weekly_$(date +%Y-%m-%d).md
```

### 3️⃣ 历史追踪
查看 `docs/reviews/` 目录下的历史审查报告，跟踪项目演进。

### 4️⃣ 集成到 CI/CD
在 GitHub Actions 中自动运行评估：
```yaml
- name: Gemini Pro Review
  run: python3 gemini_review_bridge.py
```

### 5️⃣ 定制审查重点
编辑 `gemini_review_bridge.py` 中的 `REVIEW_FOCUS` 来自定义审查方向。

---

## 🚨 常见问题

### Q: Gemini Pro 如何获知项目最新信息？
A: `gemini_review_bridge.py` 自动收集：
- Git 状态 (分支、提交、未提交更改)
- Notion 任务 (优先级、状态、上下文)
- 代码文件 (核心文件内容)
- 项目历史 (工单、知识图谱)

### Q: 多长时间运行一次评估？
A: 建议：
- **日常**: 在关键决策前运行
- **每周**: 每周一或每周五运行综合评估
- **按需**: 遇到问题或不确定时运行

### Q: 如何在没有 Gemini Pro 的情况下使用？
A: 仍然可以使用：
- Git 自动同步到 Notion (✅ 工作)
- Notion 任务管理 (✅ 工作)
- GitHub-Notion 知识沉淀 (✅ 工作)
- 仅 Gemini Pro 评估需要 API 密钥

### Q: 报告保存在哪里？
A: 两个位置：
1. **Notion**: AI Command Center 数据库
2. **本地**: `docs/reviews/` 目录

---

## 📱 在线访问

**关键 Notion 页面**:

| 用途 | 链接 |
|------|------|
| AI 任务中心 | https://www.notion.so/2cfc88582b4e817ea4a5fe17be413d64 |
| 工单管理 | https://www.notion.so/2cfc88582b4e816b9a15d85908bf4a21 |
| 知识图谱 | https://www.notion.so/2cfc88582b4e811d83bed3bd3957adea |
| 项目主页 | https://www.notion.so/2cfc88582b4e801bb15bd96893b7ba09 |

---

## 🎬 30 秒演示

```bash
# 1. 运行评估
python3 gemini_review_bridge.py

# 2. 等待 2-3 分钟

# 3. 查看本地报告
cat docs/reviews/latest_review.md

# 4. 在 Notion 中查看任务
# 打开 AI Command Center，查看新创建的审查任务

# 完成！
```

---

## 🏁 总结

1. **最快上手**: `python3 gemini_review_bridge.py`
2. **自动工作**: Git 提交自动同步 Notion
3. **持续学习**: 查看 `HOW_TO_USE_GEMINI_REVIEW.md` 了解更多
4. **需要帮助**: 查看 `GEMINI_PRO_INTEGRATION_GUIDE.md` 了解技术细节

---

**🚀 现在就开始吧！**

```bash
python3 gemini_review_bridge.py
```

---

*版本: 1.0*
*最后更新: 2025-12-21*
*工单: #010.9 完成*


---

## HOW_TO_USE_GEMINI_REVIEW.md

# 📖 如何使用 Gemini Pro 进行项目评估

## 🎯 快速开始（5 分钟）

### 方式 1️⃣: 直接运行审查系统（推荐）

```bash
# 在终端执行
python3 gemini_review_bridge.py
```

**发生了什么**：
1. 🔍 自动获取最新项目状态（Git、Notion、工单进度）
2. 📊 收集核心代码文件上下文
3. 📝 生成完整的审查提示（4000+ 字符）
4. 🤖 发送给 Gemini Pro 进行深度分析
5. 💾 保存审查报告到 Notion AI Command Center
6. 📁 本地备份到 `docs/reviews/`

**审查报告包含**：
- ✅ 项目现状评估
- 🎯 下一步关键目标
- 💡 具体优化建议
- ⚠️ 潜在风险警告
- 📈 性能改进机会

### 方式 2️⃣: 通过 Notion 创建专项审查任务

#### **步骤 1: 打开 AI Command Center**

访问：https://www.notion.so/2cfc88582b4e817ea4a5fe17be413d64

#### **步骤 2: 创建新任务**

点击 `+ Add a page`，填写以下信息：

```
标题: 🔍 Gemini Pro 项目评估 - [日期]

上下文文件选择：
☑️ src/strategy/risk_manager.py
☑️ nexus_with_proxy.py
☑️ src/feature_engineering/
☑️ bin/run_backtest.py
```

#### **步骤 3: 在页面正文中写入评估请求**

```markdown
# 项目全面评估请求

## 📋 评估重点

1. **架构评估**
   - MT5 实盘交易系统的整体设计是否合理？
   - 核心模块之间的耦合度如何？
   - 是否有架构优化空间？

2. **代码质量分析**
   - 当前代码有哪些潜在的 bug 或性能问题？
   - 是否遵循 Python 最佳实践？
   - 有哪些安全隐患需要关注？

3. **风险管理系统**
   - Kelly 公式的实现是否正确？
   - 风险控制机制的有效性？
   - 实盘操作的安全保障？

4. **下一步规划**
   - 工单 #011 的优先顺序是什么？
   - 有哪些技术债务需要优先处理？
   - 未来 2 周的关键里程碑是什么？

5. **优化建议**
   - 最有价值的优化项是什么？
   - 预期收益和工作量的权衡？
   - 如何快速实现最大价值？

## 📊 当前项目状态

- **总代码量**: 14,500+ 行
- **测试覆盖**: ~85%
- **特征维度**: 75+
- **完成工单**: #008, #010, #010.5, #010.9
- **当前焦点**: #011 (MT5 实盘交易系统对接)
- **团队**: Claude Sonnet 4.5 + Gemini Pro 协同

## 🎯 期望输出

请提供：
1. 项目整体评分 (0-100)
2. 前 5 个最需要改进的地方
3. 前 3 个最重要的优化建议
4. 工单 #011 的详细实施方案
5. 技术债务清单和优先级
```

#### **步骤 4: 触发 Gemini 审查**

在任务中添加标签或关键词（自动触发）：
- `gemini-review` - 触发 Gemini Pro 审查
- `urgent` - 加急审查

**或者手动运行脚本**：
```bash
python3 gemini_review_bridge.py
```

#### **步骤 5: 等待 Gemini 的回复**

- ⏱️ 预期等待时间: 1-5 分钟
- 📍 位置: AI Command Center 中会自动出现新的回复
- 📄 本地备份: `docs/reviews/gemini_review_[时间].md`

---

## 📋 详细使用场景

### 场景 1: 定期周报评估

**目的**: 每周获取项目状态评估和下周规划建议

#### 操作步骤：

```markdown
# 周报: 第 XX 周项目评估

## 本周完成
- [x] 实现 MT5 API 连接
- [x] 完成风险管理集成
- [x] 通过 Gemini Pro 审查

## 本周遇到的问题
- Kelly 公式在极端市场条件下的稳定性
- 高频数据处理的延迟问题

## 下周计划
- 完成订单执行引擎
- 优化数据处理管道
- 进行实盘前的最后测试

## Gemini Pro 的建议
[将审查结果粘贴在这里]
```

**运行命令**：
```bash
python3 gemini_review_bridge.py
```

### 场景 2: 代码审查与优化

**目的**: 让 Gemini 深度审查特定功能的代码实现

#### 操作步骤：

```markdown
# MT5 API 实现代码审查

## 代码位置
- `src/strategy/mt5_connection.py` (新建)
- `src/strategy/order_executor.py` (新建)

## 审查重点

1. **连接稳定性**
   - 错误重试机制是否充分？
   - 网络断线恢复策略？
   - 心跳检测是否必要？

2. **订单执行安全性**
   - 双重确认机制？
   - 风险限制检查？
   - 异常回滚机制？

3. **性能指标**
   - 订单执行延迟 < 100ms?
   - 数据处理吞吐量?
   - 内存占用情况?

4. **代码质量**
   - 是否有潜在的竞态条件？
   - 异常处理是否完善？
   - 日志输出是否充分？

## 期望建议
- 最关键的改进项
- 具体的代码示例
- 实施优先级
```

**命令**：
```bash
python3 gemini_review_bridge.py
```

### 场景 3: 风险评估与对策

**目的**: 评估实盘交易的风险并获得对策建议

```markdown
# 实盘交易系统风险评估

## 需要评估的风险

1. **资金安全风险**
   - Kelly 公式在市场崩盘时的表现
   - 最大单笔亏损限制是否足够
   - 账户爆炸的概率如何？

2. **系统可靠性风险**
   - API 断线导致的自动平仓机制
   - 数据延迟导致的交易延迟
   - 程序崩溃的恢复机制

3. **交易策略风险**
   - 当前策略的最大回撤
   - 胜率和盈亏比的稳定性
   - 过拟合的程度

4. **合规与监管风险**
   - 交易频率是否会触发市场监管
   - 资金流向是否规范
   - 日志记录是否完善

## 期望输出

1. 各类风险的评分 (低/中/高/严重)
2. 立即需要处理的风险
3. 风险缓解方案
4. 实盘前的检查清单
```

**命令**：
```bash
python3 gemini_review_bridge.py
```

### 场景 4: 技术债务优先级排序

**目的**: 让 Gemini 识别技术债务并排列优先级

```markdown
# 技术债务分析与优先级排序

## 当前已知的技术债务

1. **数据处理管道**
   - Dask 并行处理可能有内存泄漏
   - 特征生成缺少增量更新机制

2. **Kelly 资金管理**
   - 极端市场条件下的稳定性未经验证
   - 多品种交易的相关性处理不完善

3. **错误处理**
   - API 异常恢复机制不完善
   - 订单执行失败的回滚逻辑缺陷

4. **测试覆盖**
   - 实盘场景的集成测试缺失
   - 高频交易的压力测试不足

## Gemini Pro 的任务

1. 评估每项技术债务的严重程度
2. 估算修复工作量
3. 排列优先级（按价值/工作量）
4. 给出快速修复方案
```

---

## 🔄 工作流程图

```
┌─────────────────────────────────────────────────────────────┐
│ 1️⃣ 创建 Notion 任务 (AI Command Center)                   │
│    - 标题、上下文文件、具体要求                              │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│ 2️⃣ 自动触发或手动运行审查系统                              │
│    python3 gemini_review_bridge.py                          │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│ 3️⃣ 系统自动收集项目信息                                    │
│    • Git 状态（分支、提交、变更）                           │
│    • Notion 数据（工单、任务、知识库）                      │
│    • 代码文件（核心实现）                                   │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│ 4️⃣ 生成审查提示词                                          │
│    包含：项目概览、代码上下文、优先级任务、审查重点         │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│ 5️⃣ 发送给 Gemini Pro 进行深度分析                          │
│    • 架构评估                                               │
│    • 代码质量检查                                           │
│    • 风险识别                                               │
│    • 优化建议                                               │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│ 6️⃣ 返回审查报告                                            │
│    自动保存到：                                             │
│    • Notion AI Command Center (页面中)                     │
│    • docs/reviews/gemini_review_[时间].md (本地)           │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│ 7️⃣ 查看建议并制定行动计划                                  │
│    • 更新工单 #011 的实施计划                               │
│    • 创建新的优化任务                                       │
│    • 分配开发任务给 Claude                                  │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎨 高级使用技巧

### 技巧 1: 聚焦特定问题

**在 Notion 任务中明确指定**：

```markdown
## 优先评估

⭐⭐⭐ 最紧急:
- MT5 API 连接的稳定性
- Kelly 公式在实盘中的可靠性

⭐⭐ 重要:
- 性能优化机会
- 代码质量改进

⭐ 有时间再看:
- 未来架构规划
- 长期技术债务
```

### 技巧 2: 定期对标

**建立周期性评估流程**：

```bash
# 创建定时任务（Linux/Mac）
# 在 crontab 中添加
0 9 * * 1 cd /opt/mt5-crs && python3 gemini_review_bridge.py

# 这样每周一上午 9 点自动运行评估
```

### 技巧 3: 链接历史建议

```markdown
## 与前次评估的对比

上次 Gemini 建议（12月15日）：
1. ✅ 完成 Kelly 公式优化 (已完成)
2. ✅ 实现 DSR 验证 (已完成)
3. 🔄 进行 MT5 集成测试 (进行中 - 需要反馈)
4. ⏳ 性能基准测试 (待开始)

本次评估:
- 评估这些建议的有效性
- 给出新的优化方向
- 更新下个月的工作计划
```

---

## 📊 期望的 Gemini 回复格式

通常 Gemini Pro 会返回类似这样的结构化报告：

```markdown
# MT5-CRS 项目评估报告
日期: 2025-12-21

## 📊 项目现状评分
- **总体分数**: 82/100
- **架构质量**: 85/100
- **代码质量**: 78/100
- **风险管理**: 88/100
- **可维护性**: 75/100

## 🎯 关键发现

### 1. 强项 ✅
- Kelly 公式实现科学合理
- 风险管理框架完善
- 并行处理架构先进

### 2. 弱项 ⚠️
- MT5 集成测试不足
- 极端市场场景缺少验证
- 性能优化空间仍大

### 3. 风险 🔴
- 高频交易延迟风险
- 数据同步的可靠性
- 账户爆炸的防护

## 💡 前 5 个优化建议

### 1. 🔥 优先级最高 - 实盘风险防护
**问题**: 账户爆炸防护机制不足
**方案**: 实现多层风控检查
**工作量**: 3-5 天
**预期收益**: 大幅降低实盘风险

### 2. 性能优化 - 订单执行延迟
**问题**: API 调用延迟可能影响交易机会
**方案**: 实现异步处理 + 连接池
**工作量**: 2-3 天
**预期收益**: 延迟降低 50%+

... (更多建议)

## 🗺️ 下一步路线图

### 第 1 阶段 (1-2 周) - 风险防护
1. 完成多层风控检查
2. 实现账户资金防护
3. 进行压力测试

### 第 2 阶段 (2-3 周) - 性能优化
1. 优化 API 调用
2. 实现并发控制
3. 性能基准测试

### 第 3 阶段 (3-4 周) - 实盘测试
1. 模拟交易验证
2. 完整集成测试
3. 性能监控部署

## 📋 工单 #011 实施建议

**推荐顺序**:
1. MT5 API 基础连接 (3-4 天)
2. 订单执行引擎 (2-3 天)
3. 风险控制集成 (2-3 天)
4. 压力测试与验证 (3-4 天)

**关键检查点**:
- ✅ API 连接稳定性 > 99.9%
- ✅ 订单执行延迟 < 100ms
- ✅ 风险限制生效率 100%
- ✅ 模拟交易盈利能力验证
```

---

## 🎯 快速命令参考

```bash
# 1️⃣ 快速启动评估
python3 gemini_review_bridge.py

# 2️⃣ 检查项目健康状态
python3 check_sync_status.py

# 3️⃣ 查看最新的审查报告
cat docs/reviews/gemini_review_*.md | tail -100

# 4️⃣ 启动 AI 监控（获得 Claude 的任务回复）
python3 nexus_with_proxy.py &

# 5️⃣ 查看 Notion 中的所有评估任务
# 打开 https://www.notion.so/2cfc88582b4e817ea4a5fe17be413d64
```

---

## ✅ 成功标志

当您成功使用 Gemini Pro 进行项目评估时，您会看到：

- ✅ Notion AI Command Center 中自动出现新的回复任务
- ✅ `docs/reviews/` 目录下出现新的评估报告
- ✅ 报告包含具体的优化建议和优先级排序
- ✅ 建议与当前项目状态高度相关
- ✅ 可以直接将建议转化为工单 #012, #013 等

---

## 🤔 常见问题

### Q: Gemini 为什么需要这么多信息？
A: 完整的项目信息能让 Gemini 给出更精准、更实用的建议。没有背景的审查往往是泛泛而谈。

### Q: 多久评估一次？
A: 建议周期：
- **重大变更后**: 立即评估
- **周期性**: 每周一次（了解进度）
- **关键节点**: 大功能完成后（验证设计）

### Q: 如何确保 Gemini 的建议质量？
A:
1. 提供清晰的评估目标
2. 提供相关的代码上下文
3. 说明当前的关键挑战
4. 将建议与之前的反馈对比

### Q: 建议不采纳怎么办？
A: 完全正常！Gemini 的建议是参考意见，您有最终决定权。建议：
- 评估建议的工作量 vs 收益比
- 考虑当前的优先级
- 在 Notion 中记录为什么采纳或拒绝

---

## 🎬 实际操作演示

### 场景: 今天下午想让 Gemini 评估工单 #011 的实施方案

**5 分钟快速流程**：

```bash
# 1. 运行评估系统（自动获取最新项目信息）
python3 gemini_review_bridge.py

# [等待 1-3 分钟，Gemini Pro 进行深度分析]

# 2. 查看生成的报告
cat docs/reviews/gemini_review_latest.md

# 3. 打开 Notion 查看 AI Command Center
# 会看到类似这样的任务：
# 🔍 Gemini Pro 深度评估 - 12月21日
#    - 工单 #011 实施路线图
#    - 5 个关键优化建议
#    - 风险评估和对策
#    - 下周优先级排序

# 4. 根据建议制定行动计划
# 创建 4-5 个新的子工单，让 Claude 逐个实现
```

**完全自动化，无需任何手动操作！**

---

**🏆 现在您掌握了如何高效地使用 Gemini Pro 进行项目管理和技术决策。从此告别低效的人工分析，让 AI 帮助您制定最优的技术路线图！**

---


**导出统计**: 2/4 个文档
