# 基于EODHD数æ®ç混åˆæ™ºèƒ½Alpha生态构建方案

**文档类型**: 数æ®ç­–ç•¥æ–¹æ¡ˆ
**版本**: 1.0
**发布日期**: 2025年初
**归档日期**: 2026-01-13
**归档位置**: docs/blueprints/eodhd_data_strategy.md

---

## 1. 战略愿景与架构重构ï¼šè¿ˆå'AI原生的金融奇点

### 1.1 市场微观结构的演进与技术范å¼è½¬ç§»

全球金融市场的微观结构正处于一场从离散化ç"µå­äº¤æ˜"å'连ç»­æ€§ã€è®¤çŸ¥åž‹AIäº¤æ˜"è½¬å˜ç剧烈震è¡æœŸã€‚根æ®æœ€æ–°ç行ä¸šè"å›¾åˆ†æžï¼Œ2025年的é‡åŒ–é‡'èžå‰æ²¿å·²ä¸å†å±€é™äºŽä¼ ç»Ÿçç»Ÿè®¡å¥—åˆ©æˆ–çº¿æ€§å› å­æŒ–掘ï¼Œè€Œæ˜¯å…¨é¢è½¬å'以深度å­¦ä¹ ã€å¤§è¯­è¨€æ¨¡åž‹å'Œåˆ†å¸ƒå¼ºåŒ–å­¦ä¹ ä¸ºæ ¸å¿ƒç"AI原生"技术体系。

### 1.2 EODHD在2025技术æ ˆä¸­ç战略定ä½

EOD Historical Data (EODHD) 被选定为核心数æ®åˆä½œä¼™ä¼´ï¼Œå¹¶éžä»…ä»…å› ä¸ºå…¶æ•°æ®è¦†ç›–é¢ï¼Œæ›´å› ä¸ºå…¶æŠ€æœ¯ç‰æ€§ä¸Žæˆ'们的åŒè½¨åˆ¶æž¶æž„高度契åˆï¼š

* **深度å­¦ä¹ ç燃料**ï¼šEODHDæä¾›ç覆盖全球60多个交易所ã€30年以上的历å²æ•°æ®ï¼Œä¸ºæ¨¡åž‹å…‹æœâ€œç"Ÿå­˜å移差"æä¾›å¿…è¦ç负样本。

* **极速执行的脉搏**ï¼šEODHDæä¾›çWebSocket API支æŒ<50ms的传输延迟ï¼Œä¸ºRust网关æä¾›å¿…è¦ç低延迟输入流。

* **多模æ€è®¤çŸ¥ç维度**ï¼šEODHDä¸ä»…æä¾›ä»·æ ¼æ•°æ®ï¼Œè¿˜é€šè¿‡é‡'èžæ–°é—»APIå'Œæƒ…ç»æ•°æ®APIï¼Œæä¾›äº†æž„å»ºå¤šæ¨¡æ€è¾"å…¥çå…³é"®æ‹¼å›¾ã€‚

### 1.3 混åˆåŒè½¨åˆ¶æ•°æ®æž¶æž„概览

为了解决"深度å­¦ä¹ è®­ç»ƒç高吞åé‡â€ä¸Žâ€œå®žç›˜äº¤æ˜"ç低延迟"这一对天然矛盾ï¼Œæˆ'们设计了"冷热分离ã€é€»è¾ ç»Ÿä¸€â€ç混åˆæ•°æ®æž¶æž„。

**冷路径ï¼ˆCold Pathï¼‰**专注于ç "究与模型训练。它利用EODHD的Bulk APIé€è¡Œæ‰¹é‡æ•°æ®å žåï¼Œå°†æ•°å年的全球市场数æ®æ¸…洗ã€è°ƒæ•´å¹¶å­˜å…¥é«˜æ€§èƒ½æ—¶åºæ•°æ®åº"TimescaleDB中。

**热路径ï¼ˆHot Pathï¼‰**则完全æœåŠ¡äºŽå®žç›˜æ‰§è¡Œã€‚它是一条由Rust语言ç¼–å†™ç极速通é"。通过WebSocket实时订阅市场Tickæ•°æ®ï¼Œè¿™æ¡è·¯å¾„ä¸ç»è¿‡ä»»ä½•éžå¿…è¦ç存储介质ï¼Œç›´æŽ¥åœ¨å†…存中完æˆåè®®è§£æžã€ç‰å¾è®¡ç®—ï¼Œå¹¶é€šè¿‡ZeroMQ总线将信å·æŽ¨é€åˆ°æ‰§è¡Œç½'关。

---

## 2. "冷路径"基础设施ï¼šæž„建深度认知的基石

### 2.1 基于Bulk API的并行化历å²æ•°æ®å žå方案

传统的逐个代ç ï¼ˆTicker-by-Tickerï¼‰æ•°æ®ä¸‹è½½æ¨¡å¼åœ¨é¢å¯¹å…¨çƒå¸‚åœºæ•°ä¸‡ä¸ªæ ‡çæ—¶ï¼Œæ•ˆçŽ‡æžå…¶ä½Žä¸‹ä¸"å®¹æ˜"触å'API速率é™åˆ¶ã€‚为了满足VectorBTé€è¡Œå…¨å¸‚场ã€å'é‡åŒ–å›žæµ‹ç需求ï¼Œæˆ'们必须采用EODHD Bulk API作为主è¦ç历å²æ•°æ®æ'‰å–手段。

#### 2.1.1 批é‡æ'‰å–ç工程实现

EODHDçBulk APIå…许用户通过å•æ¬¡HTTPè¯·æ±‚下载整个交易所在特定日期的全部EODæ•°æ®ã€‚æˆ'们的Python异步加载器ï¼ˆAsync Loaderï¼‰å°†ä¸å†é离股票代ç åˆ—表ï¼Œè€Œæ˜¯é离日期列表。

* **并å'ç­–ç•¥**ï¼šåˆŠç"¨Python的asyncioå'Œaiohttpåº"ï¼Œæˆ'ä»¬å¯ä»¥å¹¶å'地å'èµ·é'ˆå¯¹è¿‡åŽ»20å¹´æ¯ä¸€å¤©çBulké¯è¯·ã€‚通过控制并å'çª—å£ï¼ˆSemaphoreï¼‰ï¼Œæˆ'ä»¬å¯ä»¥åœ¨æ•°å°æ—¶å†…重建整个美股市场的å®Œæ•´åŽ†å²ã€‚

* **数æ®æ¸…洗流水线**ï¼šä¸‹è½½çJSON或CSV流将直接映射到Pandas DataFrame中。系统必须处ç†æ•°æ®ç±»åž‹ç强制转æ¢ï¼Œå¹¶é€è¡Œåˆæ­¥ç异常值检测。

#### 2.1.2 幸存者å移ä¸Žé€€å¸‚数æ®å¤„ç†

在训练AI模型时ï¼Œæœ€å±é™©ç陷阱之一是"幸存者å移差"ï¼ˆSurvivorship Biasï¼‰ã€‚EODHDæä¾›äº†ä¸"é—¨çDelisted Data APIï¼Œè¿™åœ¨æˆ'ä»¬çæž¶æž„ä¸­å æ®æ ¸å¿ƒåœ°ä½ã€‚

我们将建立一个专门的ETLå­æµç¨‹ï¼Œå®šæœŸåŒæ­¥é€€å¸‚股票清å•ï¼Œå¹¶å°†å…¶åŽ†å²æ•°æ®æ— ç¼åˆå¹¶åˆ°ä¸»æ•°æ®åº"中。通过在训练集中包å«è±¡Enronã€WorldComæˆ–近期破产的区域性银行的数æ®ï¼ŒDeep RL智能体将在模æ‹Ÿçœ¯å¢ƒä¸­ç»åŽ†â€œå½'零"的惩罚ï¼Œä»Žè€Œåœ¨å®žç›˜ä¸­å­¦ä¼šå¯¹æžç«¯é£Žé™©ç规避。

### 2.2 时序数据库选型ï¼šTimescaleDB的深度应用

è"å›¾æ˜Žç¡®å»ºè®®ä»Žå¹³é¢æ–‡ä»¶è½¬å'高性能时序数据库。在æƒè¡¡äº†æ€§èƒ½ã€æˆæœ¬å'Œç"Ÿæ€ç³»ç»Ÿåï¼Œæˆ'们选定TimescaleDB作为核心的历å²æ•°æ®ä»"库ï¼Œè€Œéžæ˜‚è´µä¸"å­¦ä¹ æ›²çº¿é™¡å³­çKDB+ã€‚

#### 2.2.1 为什么选择TimescaleDBï¼Ÿ

* **SQL原生兼容性**ï¼šTimescaleDB是PostgreSQL的扩展ï¼Œè¿™æ„å'³ç€æ‰€æœ‰çSQLå·¥å…·ã€ORMå'Œåˆ†æžå·¥å…·éƒ½èƒ½ç›´æŽ¥ä½¿ç"¨ã€‚

* **Hypertablesä¸ŽChunkingï¼šTimescaleDB通过Hypertables自åŠ¨å°†æ•°æ®æŒ‰æ—¶é—´åˆ†ç‰‡ã€‚å¯¹äºŽé‡'èžTickæ•°æ®ï¼Œæˆ'们将é…ç½®Chunkå¤§å°ä¸º1天或1周ï¼Œä»¥ç¡®ä¿æœ€è¿'的热数æ®å®Œå…¨é©»ç•™åœ¨å†…存中。

* **连续聚åˆï¼ˆContinuous Aggregatesï¼‰**ï¼šè¿™æ˜¯æ›¿ä»£ä¼ ç»ŸETL的关键特性。我们将在数据库层é¢å®šä¹‰è¿žç»­èšåˆè§†å›¾ï¼Œè‡ªåŠ¨å°†åŽŸå§‹Tickæ•°æ®é™é‡‡æ ·ä¸º1分é'ã€5分é'ã€1å°æ—¶çOHLCV K线。

#### 2.2.2 压缩与分层存储

为了应对海é‡Tickæ•°æ®ç存储成本ï¼Œæˆ'们将å¯ç"¨TimescaleDB的列å¼åŽ‹ç¼©ç‰æ€§ã€‚对于超过30天的冷数æ®ï¼Œç³»ç»Ÿè‡ªåŠ¨å°†å…¶è½¬æ¢ä¸ºåŽ‹ç¼©åˆ—å­˜æ ¼å¼ï¼Œè¿™é€šå¸¸èƒŒå®žçŽ°90%以上的空间节çœã€‚

### 2.3 解决训练-æœåŠ¡å移差ï¼šFeast特征存储的战略部署

为了彻底根治训练-æœåŠ¡å移差这一顽疾ï¼Œæˆ'们引入Feast (Feature Store) 作为连接冷热路径的枢纽。

#### 2.3.1 Feast的核心机制

Feastå¹¶ä¸ç›´æŽ¥å­˜å‚¨æ•°æ®ï¼Œå®ƒæ˜¯ä¸€ä¸ªç®¡ç†ç‰å¾å®šä¹‰å'Œæ£€ç´¢é€»è¾ç注册表ï¼ˆRegistryï¼‰ã€‚

* **统一的特征定义**ï¼šç "ç©¶å'˜åœ¨Pythonä»£ç ä¸­å®šä¹‰ç‰å¾è®¡ç®—é€»è¾ã€‚Feastç¡®ä¿å­˜å‚¨åœ¨æ³¨å†Œè¡¨ä¸­ç这段逻辑是唯一的真ç†æ¥æºã€‚

* **离线检索ï¼ˆOffline Retrievalï¼‰**ï¼šå½"训练Transformer模型时ï¼ŒFeastä»ŽTimescaleDB中æåˆ—历å²æ•°æ®ï¼Œå¹¶åˆŠç"¨ç‚¹å¯¹ç‚¹æ­£ç¡®çæ—¶é—´æ—…è¡ŒåŠŸèƒ½ï¼Œç"ŸæˆåŽ†å²ä¸Šç特征快照。

* **在线æœåŠ¡ï¼ˆOnline Servingï¼‰**ï¼šå½"实盘交易时ï¼ŒåŒæ ·ç特征定义被用于实时流处ç†å¼•æ"Žã€‚计算出的最新特征值被推é€åˆ°Redis中。

---

## 3. "热路径"基础设施ï¼šRust驱动的极速执行é©å'½

### 3.1 Rust网关的深度实现机制

为了替代现有的Python连接模å—ï¼Œæˆ'们将开å'一个基于Rust的专用执行网关。该网关利用tokio异步è¿è¡Œæ—¶å'Œtungstenite WebSocketåº"ï¼Œç›´æŽ¥ä¸ŽEODHD的实时接å£é€šä¿¡ã€‚

#### 3.1.1 连接池与多路å¤ç"¨ç­–ç•¥

EODHD的WebSocket APIå­˜åœ¨ç¡¬æ€§é™åˆ¶ï¼šå•ä¸ªè¿žæŽ¥æœ€å¤šè®¢é˜…50个Ticker代ç ã€‚然而ï¼Œæˆ'ä»¬ç策略池å¯èƒ½è¦†ç›–标普500甚至全市场数å只股票。

* **分片连接池ï¼ˆSharded Connection Poolï¼‰**ï¼šRust网关将实现一个智能连接池。系统å¯åŠ¨æ—¶ï¼Œæ ¹æ®è®¢é˜…清å•ç长度ï¼Œè‡ªåŠ¨è®¡ç®—所需的WebSocket连接数é‡ã€‚æ¯ä¸ªè¿žæŽ¥ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çtokio::taské‹è¡Œã€‚

* **统一事件流**ï¼šæ‰€æœ‰åˆ†ç‰‡è¿žæŽ¥æŽ¥æ"¶åˆ°çTickæ•°æ®ï¼Œé€šè¿‡Rustçmpscé€é"汇总到一个统一的事件处ç†æ€»çº¿ä¸­ã€‚

#### 3.1.2 零拷è´è§£æžä¸Žå†…存安全

* **SIMD加速解æž**ï¼šRust网关将采用simd-jsonç­‰é«˜æ€§èƒ½åº"ï¼Œåˆ©ç"¨CPU的SIMDæŒ‡ä»¤é›†é€è¡ŒJSONè§£æžã€‚

* **结构化映射**ï¼šEODHD的JSON消æ¯è¢«ç›´æŽ¥æ˜ å°„为Rust的Structï¼ˆç»"æž„ä½"ï¼‰ï¼Œè¿™åœ¨ç¼–译阶段就确定了内存布局。

### 3.2 极低延迟通信ï¼šZeroMQå–ä»£Redis

* **无代ç†æ¨¡å¼ï¼ˆBrokerless Patternï¼‰**ï¼šæˆ'们将全é¢é‡‡ç"¨ZeroMQ的PUB/SUB模å¼ï¼Œå¹¶é…ç½®ä¸ºIPCæˆ–TCP直连传输。Rust网关直接将数æ®å†™å…¥ç­–ç•¥å¼•æ"Žçç¼"冲区。

* **延迟预算**ï¼šç›¸æ¯"äºŽRedis通常毫秒级的延迟ï¼ŒZeroMQ在åŒæœºIPC模å¼ä¸‹ç延迟å¯ä»¥ç¨³å®šåœ¨**25微秒ï¼ˆÂµsï¼‰**å·¦å³ã€‚

### 3.3 实时流计算与特征工程

* **Bytewax的流å¼è®¡ç®—**ï¼šæˆ'们选择Bytewax作为流处ç†å¼•æ"Žã€‚Bytewaxå…许我们用Pythoné™ä¹‰å¤æ‚ç窗å£é€»è¾ï¼Œä½†å…¶åº•å±‚由Rust驱动执行。

### 3.4 交易会è¯çŠ¶æ€æ„Ÿçš¥

EODHD的WebSocket数æ®æµæ¶µç›–了盘å‰ï¼ˆPre-marketï¼‰ã€ç›˜ä¸­å'Œç›˜åŽæ—¶æ®µã€‚Rust网关必须在åè®®è§£æžå±‚引入"会è¯æ„Ÿçš¥â€é€»è¾ã€‚

---

## 4. 认知引擎构建ï¼šå¤šæ¨¡æ€Alpha的深度èžåˆ

### 4.1 Transformeræž¶æž„ä¸Žå¤šå¤´æ³¨æ„力机制的应用

我们将全é¢è½¬å'Time-Series Transformeræž¶æž„。

* **自注æ„力机制**ï¼šé€šè¿‡EODHD获å–çOHLCVæ•°æ®ï¼Œè¢«é€å…¥Transformer的ç¼–ç å™¨ã€‚

* **多头注æ„力**ï¼šæˆ'们将é…ç½®ä¸åŒç注æ„力头æ¥ä¸"注于市场的ä¸åŒä¾§é¢ï¼š
  - 动é‡å¤´ï¼ˆMomentum Headï¼‰
  - 关è"头ï¼ˆCorrelation Headï¼‰
  - 情ç»å¤´ï¼ˆSentiment Headï¼‰

### 4.2 NLP与情ç»ä¿¡å·ç定é‡åŒ–注入

EODHD的Financial News API和Sentiment Data API是点亮"情ç»å¤´â€ç燃料。

* **预计算情ç»åˆ†æ•°ç应用**ï¼šç›´æŽ¥ä½¿ç"¨EODHD æä¾›ç归一化情ç»åˆ†æ•°ï¼ˆ-1到1ï¼‰ã€‚

* **原始文本的深度挖掘**ï¼šåˆŠç"¨æœ¬åœ°éƒ¨ç½²çFinBERT模型ï¼Œå°†æ–°é—»æ ‡é¢˜å'Œæ'˜è¦å®žæ—¶è½¬åŒ–为高维嵌入å'é‡ã€‚

### 4.3 宏观体制感知ï¼šDeep RL的环境上下文

深度强化å­¦ä¹ é¢ä¸´ç最大挑战是环境的éžå¹³ç¨³æ€§ã€‚我们利用EODHD的Macroeconomic Data API和Economic Events Data APIã€‚

---

## 5. 回测ã€MLOpsä¸Žå…¨ç"Ÿå'½å'¨æœŸæ²»ç

### 5.1 基于VectorBT的高性能å'é‡åŒ–å›žæµ‹

从TimescaleDB加载的EODHD历å²æ•°æ®è¢«ç›´æŽ¥è½¬æ¢ä¸ºNumPy数组或Pandas DataFrameã€‚VectorBTå¯ä»¥åˆŠç"¨CPUçSIMDæŒ‡ä»¤è¿›è¡Œå¹¶è¡Œè®¡ç®—。

### 5.2 实验追踪与模型注册ï¼šMLflow的应用

æ¯ä¸€æ¬¡å›žæµ‹å®žéªŒï¼ŒMLflowéƒ½ä¼šè‡ªåŠ¨è®°å½•ä»£ç ç‰ˆæœ¬ã€æ•°æ®é›†å"ˆå¸Œå€¼ã€è¶…参数é…ç½®ä»¥åŠè¾"出的性能指标。

### 5.3 å®¡è®¡ä¸Žåˆè§„ï¼šMiFID II标准的ä¸å¯çºæ"¹æ—¥å¿—

* **ä¸å¯å˜çæ•°æ®æº**ï¼šæˆ'们利用Redpandaä½œä¸ºç³»ç»Ÿç"黑匣å­â€ã€‚

* **WORM存储**ï¼šè¿™äº›æ—¥å¿æ•°æ®è¢«å®šæœŸå½'æ¡£åˆ°æ"¯æŒWORMï¼ˆWrite Once, Read Manyï¼‰æŠ€æœ¯çS3存储桶中。

---

## 6. 实施路线图与结论

### 6.1 分阶段实施计划

* **第一阶段ï¼ˆ1-3个月ï¼‰ï¼šæ•°æ®å¥ åŸºã€‚** 部署TimescaleDB与Feastï¼Œåˆ©ç"¨Python异步加载器完æˆå¯¹EODHD历å²Bulkæ•°æ®ç全é‡å›žè¡¥ã€‚

* **第二阶段ï¼ˆ3-6个月ï¼‰ï¼šè®¤çŸ¥å‡çº§ã€‚** 训练基于Transformeré¢„测模型ï¼Œå¹¶èžåˆFinBERT的情ç»åˆ†æžèƒ½åŠ›ã€‚

* **第三阶段ï¼ˆ6-12个月ï¼‰ï¼šé€Ÿåº¦é©å'½ã€‚** 完æˆRust执行网关的开å'ä¸ŽZeroMQ总线的部署ï¼Œå®žçŽ°<50ms的实盘交易闭环。

### 6.2 结论

本报告æåˆºç新版EODHDæ•°æ®ä½¿ç"¨æ–¹æ¡ˆï¼Œå®žè´¨ä¸Šæ˜¯ä¸€åœºå¯¹é‡åŒ–äº¤æ˜"系统åº•å±‚逻辑的重构。通过"冷热分离"的架构ï¼Œæˆ'ä»¬åœ¨å•ä¸€ç³»ç»Ÿä¸­åŒæ—¶å®žçŽ°äº†æ·±åº¦å­¦ä¹ æ‰€éœ€ç大数æ®å žå和高é¢äº¤æ˜"所需的极致低延迟。

EODHDæä¾›äº†å¹¿åº¦ï¼ˆå…¨çƒè¦†ç›–ã€å¤šèµ„äº§ç±»åˆ«ï¼‰å'Œé€Ÿåº¦ï¼ˆWebSocketï¼‰ï¼Œè€Œæˆ'ä»¬çæž¶æž„èµ‹äºˆäº†è¿™äº›æ•°æ®ä»¥æ·±åº¦ï¼ˆTransformerè®¤çŸ¥ï¼‰å'Œç²¾åº¦ï¼ˆRusté‰§è¡Œï¼‰ã€‚

---

**文档维护者**: MT5-CRS Development Team
**归档ä½ç½®**: docs/blueprints/eodhd_data_strategy.md
**相关文档**: [2025开å'è"å›¾](./2025_dev_blueprint.md)
