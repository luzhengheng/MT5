# 主分支 - 风险管理优化 (main)
**状态**: 当前活跃 ★ **优先级**: 高 **负责人**: AI Agent

## 分支概述

主分支专注于MT5 EA的风险管理优化，在严格控制亏损的前提下实现收益最大化。通过多指标共振信号生成、EODHD API驱动的高级新闻/经济事件过滤器、严格杠杆控制、动态仓位调整等策略，确保资金曲线平稳向上。

## 核心目标

### 风险控制目标
- 单笔风险 ≤1-2% (账户余额)
- 最大回撤 <15%
- 总浮亏 ≤10-12%
- 每日最大亏损限额 (当日亏损超3%暂停)

### 收益目标
- 信号胜率 >60%
- 盈亏比 >1:2.5
- 年化收益 >30% (低回撤)
- Sharpe比率 >1.5

## 当前进展

### 已完成 ✅
- 单笔风险控制逻辑 (基于账户余额实时调整)
- 总浮亏超过10%时自动暂停新开仓功能
- 最大同时持仓品种数限制 (默认3-5个)
- 防重单逻辑 (基于信号ID + 5分钟时间窗口)
- 风险回报比≥1:2的信号过滤
- 部分平仓机制 (盈利达到50%目标时平一半仓位)
- 新闻过滤器原型 (基于MT5内置Calendar + EODHD API)
- 日志记录统一格式 (风险/新闻/EODHD API/账户状态/杠杆监控)

### 正在进行 🚧
- 多指标共振信号生成模块完善
- EODHD API完整集成 (Economic Events + News Feed)
- 高杠杆安全使用机制
- 动态仓位调整 (参考Kelly准则)
- 波动率适应机制

### 计划中 📋
- 追踪止损和盈亏平衡功能
- 最大回撤监控模块
- EODHD Fundamental Data辅助基本面过滤
- JustMarkets Raw Spread实盘部署验证

## 技术栈

### 数据源
- EODHD API: Historical + Intraday + Technical + Fundamental + News + Economic Events
- JustMarkets: Raw Spread/Pro账户，低点差，免息Swap，最高1:3000杠杆

### 信号生成
- 趋势跟踪: 均线交叉 + MACD确认 + ADX>25过滤强趋势
- 震荡过滤: RSI超买超卖 + Bollinger Bands触带确认
- 新闻过滤: 高影响力事件 + 负面情感事件避开

### 风险管理
- 杠杆控制: 内部严格限制有效杠杆 (1:100-500)
- 仓位管理: 基于风险百分比 + Kelly准则优化
- 止损机制: 追踪止损 + 部分平仓 + 盈亏平衡

## 关键文件

| 文件路径 | 说明 |
|---------|------|
| `MQL5/Experts/MT5_EA_Risk_Management.mq5` | 主EA文件 (开发中) |
| `python/backtest/` | 回测框架和策略 |
| `scripts/deploy/pull_eodhd_full.sh` | 数据拉取脚本 |
| `data/mt5/` | EODHD数据存储 |
| `logs/` | 运行日志和错误记录 |

## 验收标准

### 功能验收
- [ ] 单笔风险控制准确执行
- [ ] 新闻过滤器有效避开高风险事件
- [ ] 信号生成胜率达到60%以上
- [ ] 回撤控制在15%以内

### 性能验收
- [ ] EODHD API响应时间 <2秒
- [ ] 信号计算延迟 <100ms
- [ ] 内存使用 <50MB
- [ ] CPU占用 <10%

## 风险评估

| 风险等级 | 风险项目 | 影响 | 缓解措施 |
|---------|---------|------|----------|
| 高 | API限流或失败 | 信号延迟 | 多重试机制 + 缓存策略 |
| 中 | 新闻过滤误判 | 错失机会 | 情感分析优化 + 人工复核 |
| 中 | 高杠杆滥用 | 巨大亏损 | 多层杠杆限制 + 实时监控 |
| 低 | 数据质量问题 | 信号失真 | 数据校验 + 异常检测 |

## 下一步行动

### 近期目标 (1-2周)
1. 完善多指标共振信号生成
2. 实现EODHD API完整集成
3. 开发高杠杆安全控制机制
4. 建立动态仓位调整系统

### 中期目标 (1月)
1. 实现追踪止损和盈亏平衡
2. 集成波动率适应机制
3. 完善新闻过滤器精度
4. 准备实盘部署验证

### 长期目标 (3月)
1. 达到夏普比率>1.5
2. 实现年化收益>30%
3. 建立完整的风险监控面板
4. 支持多品种多周期扩展

## 协作要求

### 分支管理
- 所有修改需通过PR审查
- 重大功能变更需详细测试
- 风险相关代码需双人复核

### 文档更新
- 每周更新进展报告
- 重要决策记录备忘
- 问题解决方案文档化

### 沟通机制
- 每日简报 (进展/问题/计划)
- 每周评审 (成果/调整/规划)
- 紧急问题立即上报

---

**最后更新**: 2025-12-16
**负责人**: AI Agent
**联系方式**: 项目群/邮件
